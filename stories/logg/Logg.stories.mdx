import { Meta, Preview, Story, Props } from '@storybook/addon-docs/blocks';
import { withA11y } from '@storybook/addon-a11y';
import { Logg, Hendelse } from '../../packages/logg/src';
import { hendelser, statusHendelser, filtere, statusFiltere, ExampleHendelse, ExampleFilter } from './exampleData';
import './logg.css';

<Meta title="Logg" component={Logg} decorators={[withA11y]} />

# Logg

Viser meldinger og hendelser, f.eks. notater fra saksbehandlere, varselmeldinger, eller mottatte sykmeldinger/sÃ¸knader.

<Preview withSource="open">
    <Story name="logg">
        <Logg hendelser={hendelser} filtere={filtere} />
    </Story>
</Preview>

<Props of={Logg} />

En hendelse er et objekt som beskriver meldingen som skal vises i loggen. Strukturen til objektet ser slik ut:

<Props of={ExampleHendelse} />

## Custom filtere

Hendelser kan filtreres i listen med `filtere`-propen man gir komponenten. Dette er en liste av objekter som beskriver
hvordan man Ã¸nsker Ã¥ filtrere listen for hver enkelt hendelses-/meldingstype. Et `Filter`-objekt ser slik ut:

<Props of={ExampleFilter} />

### Filtrering pÃ¥ status

<Preview>
    <Logg hendelser={statusHendelser} filtere={statusFiltere} />
</Preview>

```typescript
export const statusFiltere: Filter[] = [
    {
        filterFunction: (_: Hendelse) => true,
        renderProp: <span className="filterknapp">ğŸŒˆ</span>
    },
    {
        filterFunction: (hendelse: Hendelse) => hendelse.status === 'feil',
        renderProp: <span className="filterknapp">ğŸš¨</span>
    },
    {
        filterFunction: (hendelse: Hendelse) => hendelse.status === 'advarsel',
        renderProp: <span className="filterknapp">ğŸ§€</span>
    },
    {
        filterFunction: (hendelse: Hendelse) => hendelse.status === 'suksess',
        renderProp: <span className="filterknapp">âœ…</span>
    },
    {
        filterFunction: (hendelse: Hendelse) => hendelse.status === 'info',
        renderProp: <span className="filterknapp">ğŸ¥¶</span>
    },
];
```

## Splittet header og liste

Det kan tenkes at man Ã¸nsker Ã¥ plassere raden med filterknappene og listen med hendelsene i forskjellige komponenter.
I disse tilfellene kan man bruke komponentene `<LoggHeader />` og `<LoggListe />`, som ikke tar noen props men henter
hendelser og filtre fra en `<LoggContext.Provider />`. Her kan man f.eks. bruke `<LoggProvider />` eller lage sin egen
provider som implementerer en provider for `LoggContext`, men det viktige er uansett at man plasserer denne over headeren
og listen i React-treet i appen slik at de kan hente ut context-verdiene de trenger.

```jsx
<LoggProvider hendelser={hendelser} filtre={filtre}>
    <LoggHeader />
    <LoggListe />
</LoggProvider>
```
